config: secrets.yaml

s3:
  upload: false
  bucket_name: restoration-monitoring
  folder_prefix: tree_verification/output/project_data

asana:
  project_gid: 1209713669431043
  section: Remote
  dry_run: True

opt_api:
  opt_url: https://portal.opentopography.org/API/globaldem

tm_api:
  tm_staging_url: https://api-staging.terramatch.org/research/v3/sitePolygons?  
  tm_prod_url: https://api.terramatch.org/research/v3/sitePolygons?

criteria:
  canopy_threshold: 60                                         # threshold for identifying open vs closed canopy projects
  cloud_thresh: 50                                             # threshold for identifying image quality
  off_nadir: 30                                                # number of degrees that the sensor varies from vertical
  sun_elevation: 30
  img_count: 1                                                 # threshold for identifying image availability
  baseline_range: [-365, 0]                                    # baseline window (1 year before plant start date)
  ev_range: [730, 1095]                                        # EV window (2 years after plant start date)
  drop_missing: False
  slope_thresh: 20
  rules: tests/data/source_csv/rule_template.csv

cost:
  field: 0.32
  remote: 20.0

outfile:
  data_version: 06-30-2025
  experiment_id: exp1
  cohort: c2
  portfolio: tests/data/source_csv/prj_ids_{cohort}_{data_version}.csv
  geojsons: tests/data/source_geojsons/
  tm_response: tests/data/scratch_files/{cohort}_{data_version}.json
  slope_stats: tests/data/scratch_files/slope_statistics_{cohort}_{data_version}.csv
  project_stats: tests/data/scratch_files/{name}_slope_stats.csv
  feats: tests/data/source_csv/tm_api_{cohort}_{data_version}.csv
  feats_maxar: tests/data/source_csv/tm_api_{cohort}_{data_version}.csv
  maxar_meta: tests/data/source_csv/comb_img_availability_{cohort}_{data_version}.csv
  tree_results: tests/data/source_csv/dtree_output_{cohort}_{data_version}_{experiment_id}.csv
  poly_decision: tests/data/source_csv/poly_output_{cohort}_{data_version}_{experiment_id}.csv
  prj_decision: tests/data/scratch_files/prj_output_{cohort}_{data_version}_{experiment_id}.csv

suitability:
  area_col: area
  min_coverage: 0.6         # require at least 60% of project area to have a valid polygon score
  thresholds:
    weak_field: 30
    weak_remote: 55
    strong_remote: 70
  special_labels:
    mangrove_area_frac_threshold: 0.10     # label "mangrove" if ≥10% of total area is mangrove
    review_area_frac_threshold:  0.10      # label "review required" if ≥10% is review
    precedence: ["mangrove", "review required", "not available"]

  # How to map raw axis score -> 0..100
  scale:
    method: logistic   # or "minmax"
    k: 0.8             # only used for logistic; larger k => steeper curve
    min: -6            # only used for minmax
    max: 6

  # Optional nudges from your discrete tree outputs (keeps continuity)
  base_bonus:
    strong remote:  +1.0
    weak remote:    +0.5
    weak field:     -0.5
    strong field:   -1.0

  # Feature contributions (same columns you already have)
  features:
    common:
      baseline_canopy:
        open:   +2.0
        closed: -2.0
      slope:
        steep:  -2.0
        flat:   -0.5
      target_sys:
        mangrove: null  # we’ll mask these to NaN in code (not part of remote/field axis)

    baseline_only:
      baseline_img_count:
        ">=2": +2.0
        "==1": +1.0
        "<1":  -1.0

    ev_only:
      ev_img_count:
        ">=2": +2.0
        "==1": +1.0
        "<1":  -1.0